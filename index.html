<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰©ç†è§†è§’ä¸‹çš„AIä¼˜åŒ–å™¨ï¼šä»åŠ¨é‡åˆ°Adam</title>

    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']], // å…è®¸ä½¿ç”¨å•ç¾å…ƒç¬¦å· $ ä½œä¸ºè¡Œå†…å…¬å¼
                displayMath: [['$$', '$$'], ['\\[', '\\]']] // å…è®¸ä½¿ç”¨åŒç¾å…ƒç¬¦å· $$ ä½œä¸ºå—çº§å…¬å¼
            }
        };
    </script>

    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* è¿™é‡Œä¿ç•™åŸæœ¬çš„ CSS æ ·å¼ï¼Œä¸éœ€è¦æ”¹åŠ¨ */
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --physics-bg: #e8f6f3;
            --physics-border: #1abc9c;
            --ai-bg: #f4f6f7;
            --text-color: #333;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            margin: 0;
            padding: 0;
            background-color: #fcfcfc;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), #34495e);
            color: white;
            padding: 3rem 1rem;
            text-align: center;
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 300;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-top: 10px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        section {
            margin-bottom: 4rem;
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        h2 {
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 0.5rem;
            color: var(--primary-color);
        }

        h3 {
            color: var(--accent-color);
            margin-top: 1.5rem;
        }

        .comparison-box {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 1.5rem;
        }

        .concept-card {
            flex: 1;
            min-width: 300px;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 5px solid #ccc;
        }

        .physics-card {
            background-color: var(--physics-bg);
            border-color: var(--physics-border);
        }

        .physics-card h4 {
            color: #16a085;
            margin-top: 0;
        }

        .ai-card {
            background-color: var(--ai-bg);
            border-color: var(--accent-color);
        }

        .ai-card h4 {
            color: #2980b9;
            margin-top: 0;
        }

        .note {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
            font-size: 0.95rem;
        }

        code {
            background-color: #eee;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }

        .highlight {
            font-weight: bold;
            color: #d35400;
        }

        @media (max-width: 600px) {
            header h1 { font-size: 1.8rem; }
            .comparison-box { flex-direction: column; }
        }
        .container img {
            max-width: 90%;        /* é™åˆ¶æœ€å¤§å®½åº¦ï¼Œç•™å‡ºå·¦å³å‘¼å¸æ„Ÿ */
            max-height: 400px;     /* é™åˆ¶æœ€å¤§é«˜åº¦ï¼Œé˜²æ­¢é•¿å›¾éœ¸å± */
            height: auto;          /* ä¿æŒå›¾ç‰‡åŸå§‹é•¿å®½æ¯” */
            display: block;        /* è®¾ä¸ºå—çº§å…ƒç´ ä»¥ä¾¿å±…ä¸­ */
            margin: 1.5rem auto;   /* ä¸Šä¸‹ç•™ç™½ï¼Œå·¦å³è‡ªåŠ¨å±…ä¸­ */
            border-radius: 8px;    /* å¢åŠ åœ†è§’ï¼Œæ›´ç²¾è‡´ */
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); /* æ·»åŠ è½»å¾®é˜´å½±ï¼Œå¢åŠ ç«‹ä½“æ„Ÿ */
            object-fit: contain;   /* ç¡®ä¿å›¾ç‰‡å†…å®¹å®Œæ•´æ˜¾ç¤º */
        }
        .canvas-wrapper {
            position: relative;
            width: 100%;
            height: 280px;
            margin: 20px auto;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            background-color: #fdfdfd;
            background-image:
                    linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px),
                    linear-gradient(90deg, rgba(0,0,0,0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        .canvas-label {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.95);
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--primary-color);
            border: 1px solid #ddd;
        }

        .status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: white;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

<header>
    <h1>ä»å¤§å­¦ç‰©ç†çš„è§†è§’æ¥çœ‹æ·±åº¦å­¦ä¹ </h1>
    <p>è§£æ Momentum, RMSProp ä¸ Adam ä¼˜åŒ–å™¨èƒŒåçš„ç‰©ç†æ€ç»´</p>
</header>

<div class="container">

    <section>
        <h2>0x00. æŸå¤±å‡½æ•°ä¸é‡åŠ›åœºçš„å…³ç³»</h2>
        <p>
            åœ¨å¤§å­¦ç‰©ç†ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶ä¸€ä¸ªç‰©ä½“åœ¨é‡åŠ›åŠ¿èƒ½åœº $U(x)$ ä¸­çš„è¿åŠ¨ã€‚ç‰©ä½“å€¾å‘äºå‘åŠ¿èƒ½æœ€ä½ç‚¹è¿åŠ¨ã€‚
            åœ¨äººå·¥æ™ºèƒ½ä¸­ï¼Œåœ¨è·å¾—æŸå¤±å‡½æ•° $J(\theta)$ çš„è¿‡ç¨‹ï¼Œä¾¿å¯ä»¥ç±»æ¯”ä¸ºè¿™æ ·çš„è¿‡ç¨‹ï¼Œè€Œæˆ‘ä»¬çš„å‚æ•° $\theta$ å°±æ˜¯é‚£ä¸ªè¯•å›¾æ»šå‘å±±è°·æœ€ä½ç‚¹ï¼ˆæœ€ä¼˜è§£ï¼‰çš„å°çƒã€‚
        </p>
        <div style="text-align: center; margin: 20px 0;">
            <img src="./static/ball1.png">
        </div>
        <p>
            æœ€åŸºç¡€çš„<strong>éšæœºæ¢¯åº¦ä¸‹é™ (SGD)ç®—æ³•</strong> åœ¨è¿›è¡Œæ¢¯åº¦ä¸‹é™æ—¶ï¼Œè¿™ä¸ªå°çƒå¥½åƒæ²¡æœ‰è´¨é‡ä¸€æ ·ï¼Œæ¯ä¸€æ­¥åªå—å½“å‰çš„â€œå¡åº¦â€ï¼ˆæ¢¯åº¦ï¼‰å½±å“ï¼š
            $$ \theta_{t+1} = \theta_t - \eta \nabla J(\theta_t) $$
            è¿™å¯¼è‡´å®ƒé‡åˆ°ä¸€ä¸ªå±€éƒ¨å¹³å¦åŒºåŸŸä¼šåœæ»ï¼Œé‡åˆ°ç‹­çª„å±±è°·ä¼šç–¯ç‹‚éœ‡è¡ã€‚
            è¿™æ ·ä¹Ÿå°±å¯¼è‡´æ¨¡å‹æ²¡åŠæ³•å¾ˆå¥½åœ°æ”¶æ•›ï¼Œç”šè‡³åœ¨æ²¡æœ‰ä¸‹é™åˆ°å±±åº•å°±ä¼šåœæ­¢ä¸‹é™ã€‚
        </p>
        <img src="./static/ball2.png">
    </section>

    <section>
        <h2>0x01. åŠ¨é‡ï¼šå¼•å…¥â€œæƒ¯æ€§â€</h2>
        <p>æœ€æ™®é€šçš„æ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼Œéšæœºæ¢¯åº¦ä¸‹é™ï¼‰æœ€å¤§çš„é—®é¢˜æ˜¯å®ƒä¸å­˜å‚¨ä¹‹å‰çš„æ¢¯åº¦ä¿¡æ¯ã€‚åœ¨ç‰©ç†å­¦ä¸­ï¼Œè¿åŠ¨çš„ç‰©ä½“æ‹¥æœ‰<strong>åŠ¨é‡</strong>ï¼Œå³ $p = mv$ã€‚åŠ¨é‡ä½¿ç‰©ä½“æœ‰<strong>æƒ¯æ€§</strong>ï¼Œä½¿å…¶å€¾å‘äºä¿æŒåŸæœ¬çš„è¿åŠ¨æ–¹å‘ã€‚</p>

        <div class="comparison-box">
            <div class="concept-card physics-card">
                <h4>ğŸ›ï¸ å¤§å­¦ç‰©ç†è§†è§’</h4>
                <p>æ ¹æ®ç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼Œç‰©ä½“å—åŠ›æ”¹å˜é€Ÿåº¦ï¼Œè€Œä¸æ˜¯ç›´æ¥æ”¹å˜ä½ç½®ï¼š</p>
                $$ F = ma \Rightarrow F = m \frac{dv}{dt} $$
                <p>ç‰©ä½“çš„å½“å‰é€Ÿåº¦ä¸ä»…ä»…å–å†³äºå½“å‰çš„åŠ›ï¼ˆé‡åŠ›ï¼‰ï¼Œè¿˜å–å†³äº<strong>ä¹‹å‰çš„é€Ÿåº¦</strong>ã€‚å½“æˆ‘ä»¬å‘å‰è¿åŠ¨æ—¶ï¼Œå—åˆ°ä¸€ä¸ªå’Œè¿åŠ¨æ–¹å‘ç›¸åçš„åŠ›ï¼Œæˆ‘ä»¬ä¼šæ²¿åŸæ¥æ–¹å‘è¿åŠ¨ä¸€æ®µè·ç¦»ä¹‹åæ…¢æ…¢åœä¸‹ã€‚</p>
            </div>

            <div class="concept-card ai-card">
                <h4>ğŸ¤– AI ä¼˜åŒ–å™¨è§†è§’</h4>
                <p>Momentum ä¼˜åŒ–å™¨å¼•å…¥äº†é€Ÿåº¦å˜é‡ $v_t$ã€‚å‚æ•°æ›´æ–°ä¸å†ç›´æ¥ä½¿ç”¨æ¢¯åº¦ï¼Œè€Œæ˜¯æ›´æ–°é€Ÿåº¦ï¼š</p>
                $$ v_t = \gamma v_{t-1} + \eta \nabla J(\theta_t) $$
                $$ \theta_{t+1} = \theta_t - v_t $$
                <p>å…¶ä¸­ $\gamma$ (é€šå¸¸ä¸º0.9) ç±»ä¼¼äº<strong>ç©ºæ°”é˜»åŠ›ç³»æ•°</strong>çš„è¡¥æ•°ã€‚å®ƒç´¯ç§¯äº†è¿‡å»çš„æ¢¯åº¦ä¿¡æ¯ã€‚</p>
                <p>å¦‚æœå†™æˆä»£ç å¤§æ¦‚å°±like this</p>
                <img src="./static/code.png">
            </div>
        </div>

        <div class="note">
            <strong>ğŸ’¡ ä»ç‰©ç†æ€æƒ³æ¥ç†è§£è¿™ä¸ªä¼˜åŒ–å™¨</strong>
            å½“å°çƒæ»šè¿‡å¹³å¦çš„å¹³åŸï¼ˆæ¢¯åº¦æ¥è¿‘0ï¼‰æ—¶ï¼ŒSGDä¼šåœä¸‹æ¥ï¼Œä½†Momentumä¼˜åŒ–å™¨å› ä¸ºæœ‰<strong>æƒ¯æ€§ï¼ˆ$v_{t-1}$ï¼‰</strong>ï¼Œä¼šç»§ç»­å‘å‰å†²ï¼Œä»è€Œæœ‰æœºä¼šå†²å‡ºå±€éƒ¨æå°å€¼ã€‚
        </div>
        <div class="canvas-wrapper">
            <canvas id="canvas-momentum"></canvas>
            <div class="canvas-label">Momentum ä¼˜åŒ–å™¨</div>
            <div id="status-momentum" class="status-badge" style="background:#e74c3c;">Ready</div>
        </div>
    </section>

    <section>
        <h2>0x02. RMSPropï¼šå¼•å…¥â€œæ‘©æ“¦/èƒ½é‡è€—æ•£â€</h2>
        <p>Momentumä¼˜åŒ–å™¨è§£å†³äº†é€Ÿåº¦é—®é¢˜ï¼Œå°çƒèƒ½å¤Ÿå†²å‡ºå±€éƒ¨æœ€ä½ç‚¹ï¼Œä½†å¦‚æœå¡åº¦æé™¡ï¼Œå°çƒä¼šè·å¾—è¿‡å¤§çš„åŠ¨èƒ½ï¼Œå¯¼è‡´åœ¨è°·åº•è¿åŠ¨é€Ÿåº¦è¿‡å¿«ç”šè‡³é£å‡ºè·‘é“ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶æ¥é€‚åº”åœ°å½¢çš„â€œç²—ç³™ç¨‹åº¦â€ã€‚</p>
        <img src="./static/ball3.png">

        <div class="comparison-box">
            <div class="concept-card physics-card">
                <h4>ğŸ›ï¸ å¤§å­¦ç‰©ç†è§†è§’</h4>
                <p>æƒ³è±¡å°çƒåœ¨ä¸åŒä»‹è´¨ä¸­è¿åŠ¨ã€‚åœ¨å…‰æ»‘å†°é¢ï¼ˆæ¢¯åº¦ä¸€è‡´æ–¹å‘ï¼‰ä¸Šï¼Œé˜»åŠ›å°ï¼›åœ¨æ³¥æ½­ï¼ˆæ¢¯åº¦éœ‡è¡å‰§çƒˆï¼‰ä¸­ï¼Œé˜»åŠ›å¤§ã€‚</p>
                <p>è¿™ç±»ä¼¼äº<strong>èƒ½é‡è€—æ•£</strong>æˆ–æ‘©æ“¦åŠ›ã€‚å½“ç¯å¢ƒå˜åŒ–å‰§çƒˆï¼ˆæ¢¯åº¦å¹…å€¼å¾ˆå¤§ï¼‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¢å¤§å¢åŠ ä¸‹å«é¢çš„ç²—ç³™ç¨‹åº¦ï¼Œå¼ºè¡Œå‡é€Ÿä»¥ä¿æŒç¨³å®šã€‚</p>
                <p>ä¹Ÿå¯ä»¥ç±»ä¼¼äºéª‘è‡ªè¡Œè½¦ä¸‹å¡ï¼Œåœ¨ä¸‹å¡é™¡çš„åœ°æ–¹éœ€è¦æé—¸é¿å…è½¦é€Ÿå¤ªå¿«ï¼Œåœ¨å¹³åœ°éœ€è¦è¹¬è½¦å‘åŠ›ï¼ˆæŠµæ¶ˆæ‘©æ“¦åŠ›ï¼‰è®©è½¦éª‘å¿«ä¸€ç‚¹</p>

            </div>

            <div class="concept-card ai-card">
                <h4>ğŸ¤– AI ä¼˜åŒ–å™¨è§†è§’</h4>
                <p>RMSProp å…³æ³¨æ¢¯åº¦çš„<strong>å¹³æ–¹</strong>æ¶ˆé™¤æ¢¯åº¦æ­£è´Ÿçš„å½±å“ï¼š</p>
                $$ Eg^2_t = 0.9 Eg^2_{t-1} + 0.1 g_t^2 $$
                $$ \theta_{t+1} = \theta_t - \frac{\eta}{\sqrt{Eg^2_t + \epsilon}} g_t $$
                <p>åˆ†æ¯ä¸­çš„ $\sqrt{Eg^2_t}$ èµ·åˆ°äº†<strong>å½’ä¸€åŒ–</strong>ä½œç”¨ï¼šå¡åº¦è¶Šé™¡ï¼ˆ$g_t^2$è¶Šå¤§ï¼‰ï¼Œåˆ†æ¯è¶Šå¤§ï¼Œæ›´æ–°æ­¥é•¿åè€Œå˜å°ã€‚</p>
                <p>å¦‚æœå†™æˆä»£ç ï¼Œå¤§æ¦‚å°±like thisï¼š</p>
                <img src="./static/code2.png">
            </div>
        </div>
        <div class="canvas-wrapper">
            <canvas id="canvas-rmsprop"></canvas>
            <div class="canvas-label">RMSProp / é˜»å°¼è¿åŠ¨</div>
            <div id="status-rmsprop" class="status-badge" style="background:#16a085;">Ready</div>
        </div>
    </section>

    <section>
        <h2>0x03. Adamï¼šä¸Šé¢ä¸¤ç§ä¼˜åŒ–å™¨çš„ç»“åˆ</h2>
        <p>Adam (Adaptive Moment Estimation) æ˜¯ç›®å‰æœ€æµè¡Œçš„ä¼˜åŒ–å™¨ã€‚å®ƒçš„åå­—æ¥æºäºâ€œçŸ©ä¼°è®¡â€ï¼Œä½†ä»ç‰©ç†çš„è§†è§’ä¸Šæ¥çœ‹ï¼Œå®ƒæ˜¯ Momentum å’Œ RMSProp çš„ä¸€ä¸ªé›†åˆã€‚</p>

        <h3>ç‰©ç†çš„èåˆ</h3>
        <ul>
            <li><strong>ä¸€é˜¶çŸ© (First Moment) $m_t$ï¼š</strong> å¯¹åº”<strong>åŠ¨é‡/é€Ÿåº¦</strong>ã€‚å‘Šè¯‰æˆ‘ä»¬è¯¥å¾€å“ªä¸ªæ–¹å‘å†²ï¼ˆåˆ©ç”¨æƒ¯æ€§ï¼‰ã€‚</li>
            <li><strong>äºŒé˜¶çŸ© (Second Moment) $v_t$ï¼š</strong> å¯¹åº”<strong>æœªä¸­å¿ƒåŒ–çš„æ–¹å·®/èƒ½é‡</strong>ã€‚å‘Šè¯‰æˆ‘ä»¬è¿™é‡Œçš„åœ°å½¢æœ‰å¤šé™¡å³­ã€å¤šå¤æ‚ï¼ˆåˆ©ç”¨è‡ªé€‚åº”é˜»å°¼ï¼‰ã€‚</li>
        </ul>

        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 20px; border-left: 5px solid var(--primary-color);">
            <h4 style="margin-top:0">Adam çš„æ ¸å¿ƒå…¬å¼</h4>
            <p>1. <strong>è®¡ç®—åŠ¨é‡ (Momentum)ï¼š</strong> $ m_t = \beta_1 m_{t-1} + (1-\beta_1) g_t $</p>
            <p>2. <strong>è®¡ç®—æ³¢åŠ¨ (RMSProp)ï¼š</strong> $ v_t = \beta_2 v_{t-1} + (1-\beta_2) g_t^2 $</p>
            <p>3. <strong>åå·®ä¿®æ­£ (Bias Correction)ï¼š</strong> $\hat{m}_t = \frac{m_t}{1-\beta_1^t}, \hat{v}_t = \frac{v_t}{1-\beta_2^t}$ (å¢åŠ æ—¶é—´å‚æ•°ï¼Œè§£å†³åˆå§‹æ—¶åˆ»ä¸º0çš„é—®é¢˜)</p>
            <p>4. <strong>å‚æ•°æ›´æ–°ï¼š</strong> $$ \theta_{t+1} = \theta_t - \frac{\eta}{\sqrt{\hat{v}_t} + \epsilon} \hat{m}_t $$</p>
        </div>

        <p style="margin-top: 20px;">
            <strong>æ€»ç»“ï¼š</strong> Adam å°±åƒä¸€ä¸ªæå…¶æ™ºèƒ½çš„ç‰©ç†å°çƒã€‚å®ƒæ—¢æœ‰<strong>æƒ¯æ€§</strong>ï¼ˆMomentumï¼‰è®©å®ƒå¿«é€Ÿç©¿è¿‡å¹³ç¼“åŒºåŸŸï¼Œåˆæœ‰<strong>è‡ªé€‚åº”æ‘©æ“¦ç³»ç»Ÿ</strong>ï¼ˆRMSPropï¼‰ï¼Œåœ¨é‡åˆ°é™¡å³­æ‚¬å´–æˆ–å‰§çƒˆéœ‡è¡æ—¶è‡ªåŠ¨åˆ¹è½¦ï¼Œç¨³æ­¥ä¸‹é™ã€‚
        </p>
    </section>

</div>
<script>
    class PhysicsSimulator {
        constructor(canvasId, type) {
            this.canvas = document.getElementById(canvasId);
            this.ctx = this.canvas.getContext('2d');
            this.type = type;
            this.statusEl = document.getElementById(type === 'momentum' ? 'status-momentum' : 'status-rmsprop');

            // æ•°å­¦åæ ‡ç³»èŒƒå›´
            this.worldXMin = -2.2;
            this.worldXMax = 2.2;
            this.worldYMin = -1.5;
            this.worldYMax = 1.5;

            this.init();

            window.addEventListener('resize', () => {
                this.resize();
                this.draw();
            });

            this.loop();
        }

        init() {
            this.resize();
            this.resetBall();
        }

        resize() {
            const rect = this.canvas.getBoundingClientRect();
            const dpr = window.devicePixelRatio || 1;
            this.canvas.width = rect.width * dpr;
            this.canvas.height = rect.height * dpr;
            this.screenWidth = this.canvas.width;
            this.screenHeight = this.canvas.height;
        }

        // åæ ‡æ˜ å°„
        toScreenX(worldX) {
            return ((worldX - this.worldXMin) / (this.worldXMax - this.worldXMin)) * this.screenWidth;
        }
        toScreenY(worldY) {
            return this.screenHeight - ((worldY - this.worldYMin) / (this.worldYMax - this.worldYMin)) * this.screenHeight;
        }

        resetBall() {
            this.x = -1.8; // èµ·å§‹ç‚¹
            this.vx = 0;
            this.cacheSqGrad = 0;
            this.successTimer = 0;
            this.isStopped = false; // RMSProp ä¸“ç”¨ï¼šæ ‡è®°æ˜¯å¦å·²ç»åœç¨³
            this.statusEl.innerText = "";
        }

        // åœ°å½¢å‡½æ•°: x^4 - 2x^2 + 0.2x
        getH(x) {
            return Math.pow(x, 4) - 2 * Math.pow(x, 2) + 0.2 * x;
        }

        // æ¢¯åº¦
        getGrad(x) {
            return 4 * Math.pow(x, 3) - 4 * x + 0.2;
        }

        update() {
            const grad = this.getGrad(this.x);
            const dt = 0.016;

            if (this.type === 'momentum') {
                // === Momentum é€»è¾‘ ===
                const friction = 0.99;
                const lr = 0.5;

                this.vx = this.vx * friction - grad * lr * dt;
                this.x += this.vx;

                // çŠ¶æ€æ›´æ–°
                if (this.x > 0.5) {
                    this.statusEl.innerText = "";
                    // æˆåŠŸåæ…¢æ…¢åœä¸‹
                    this.vx *= 0.98;
                } else if (this.x > -0.5 && this.x < 0.5) {
                    this.statusEl.innerText = "";
                }

                // é‡ç½®é€»è¾‘
                if (this.x > 1.0 && Math.abs(this.vx) < 0.01) {
                    this.successTimer++;
                    if (this.successTimer > 100) this.resetBall();
                }

            } else if (this.type === 'rmsprop') {
                // === RMSProp é€»è¾‘ ===

                // å¦‚æœå·²ç»åˆ¤å®šåœç¨³ï¼Œå°±ä¸å†è®¡ç®—äº†ï¼Œé˜²æ­¢å¾®å°éœ‡è¡
                if (this.isStopped) {
                    this.successTimer++;
                    if (this.successTimer > 100) this.resetBall();
                    return;
                }

                const beta = 0.9;
                this.cacheSqGrad = beta * this.cacheSqGrad + (1 - beta) * (grad * grad);

                const lr = 0.05;
                // å¢å¤§ epsilonï¼Œè¿™æœ‰åŠ©äºåœ¨æ¢¯åº¦æ¥è¿‘0æ—¶ç¨³å®šæ•°å€¼
                const epsilon = 1e-4;

                const step = lr * grad / (Math.sqrt(this.cacheSqGrad) + epsilon);

                // æ ¸å¿ƒä¿®å¤ï¼šé˜²æ­¢éœ‡è¡çš„é€»è¾‘
                // 1. å¦‚æœæ¢¯åº¦éå¸¸å°ï¼ˆè¯´æ˜åœ¨è°·åº•ï¼‰
                // 2. å¹¶ä¸”è®¡ç®—å‡ºçš„æ­¥é•¿ä¾ç„¶åœ¨å¯¼è‡´å·¦å³æ¨ªè·³
                if (Math.abs(grad) < 0.05) {
                    // å¼ºåˆ¶å¢åŠ é˜»å°¼ï¼Œè®©å®ƒå¿«é€Ÿåœä¸‹
                    this.x -= step * 0.1;

                    // å¦‚æœç§»åŠ¨æå…¶å¾®å°ï¼Œç›´æ¥åˆ¤å®šåœæ­¢
                    if (Math.abs(step) < 0.005) {
                        this.isStopped = true;
                        this.statusEl.innerText = "";
                    }
                } else {
                    // æ­£å¸¸æ›´æ–°
                    this.x -= step;
                }

                // çŠ¶æ€æ˜¾ç¤º
                if (!this.isStopped && this.x < 0) {
                    this.statusEl.innerText = "";
                }
            }
        }

        draw() {
            this.ctx.clearRect(0, 0, this.screenWidth, this.screenHeight);

            // 1. ç»˜åˆ¶åœ°å½¢
            this.ctx.beginPath();
            this.ctx.lineWidth = 3;
            this.ctx.strokeStyle = "#34495e";

            const step = 0.05;
            let first = true;
            for (let wx = this.worldXMin; wx <= this.worldXMax; wx += step) {
                const sx = this.toScreenX(wx);
                const sy = this.toScreenY(this.getH(wx));
                if (first) { this.ctx.moveTo(sx, sy); first = false; }
                else { this.ctx.lineTo(sx, sy); }
            }
            this.ctx.stroke();

            // 2. ç»˜åˆ¶å°çƒ
            const ballSx = this.toScreenX(this.x);
            const ballSy = this.toScreenY(this.getH(this.x));

            this.ctx.beginPath();
            this.ctx.arc(ballSx, ballSy, 10, 0, Math.PI * 2);

            if (this.type === 'momentum') {
                this.ctx.fillStyle = "#e74c3c";
                // ç§»é™¤äº†ç»˜åˆ¶å°¾å·´/çº¿çš„ä»£ç ï¼Œåªä¿ç•™çº¯å‡€çš„å°çƒ
            } else {
                this.ctx.fillStyle = "#16a085";
            }
            this.ctx.fill();
            this.ctx.stroke();

            // 3. æ ‡è®°
            this.ctx.fillStyle = "#7f8c8d";
            this.ctx.font = "14px Arial";
            this.ctx.textAlign = "center";
            this.ctx.fillText("", this.toScreenX(-1), this.toScreenY(this.getH(-1)) + 30);
            this.ctx.fillText("", this.toScreenX(1), this.toScreenY(this.getH(1)) + 30);
        }

        loop() {
            this.update();
            this.draw();
            requestAnimationFrame(() => this.loop());
        }
    }

    document.addEventListener("DOMContentLoaded", () => {
        new PhysicsSimulator('canvas-momentum', 'momentum');
        new PhysicsSimulator('canvas-rmsprop', 'rmsprop');
    });

</script>
<footer style="text-align: center; padding: 2rem; color: #7f8c8d; font-size: 0.9rem;">
    <p>Some code and images are Generated by Gemini</p>
</footer>

</body>
</html>